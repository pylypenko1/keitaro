function TransMenu(n,e,t,i,s,a){this.addItem=function(n,e,t,i){var s=new TransMenuItem(n,e,this,t,i);s._index=this.items.length,this.items[s._index]=s},this.addMenu=function(n){if(!n.parentMenu==this)throw new Error("Cannot add a menu here");var t=TransMenu.direction.right,i=TransMenu.reference.topRight;e==TransMenu.direction.left&&(t=TransMenu.direction.left,i=TransMenu.reference.topLeft);null==d&&(d=new TransMenuSet(t,TransMenu.subpad_x,TransMenu.subpad_y,i));var s=d.addMenu(n);return c[n._index]=s,s.onmouseover=z,s.ondeactivate=I,s.onqueue=P,s.ondequeue=B,s},this.toString=function(){for(var e=[],t="transMenu"+(n.constructor!=TransMenuItem?" top":""),i=0,s=null;s=this.items[i];i++)e[i]=s.toString(c[i]);return'<div id="'+o+'" class="'+t+'"><div class="content"><table class="items" cellpadding="0" cellspacing="0" border="0">'+e.join("")+'</table><div id="shadowBottom'+o+'" class="shadowBottom"><img src="'+TransMenu.spacerGif+'" width="1" height="1"></div><div id="shadowRight'+o+'" class="shadowRight"><img src="'+TransMenu.spacerGif+'" width="1" height="1"></div><div id="background'+o+TransMenu.sMenuId+'" class="background"><img src="'+TransMenu.spacerGif+'" width="1" height="1"></div></div></div>'},this.initialize=function(){(function(){var n=document.getElementById(o),e=n.all?n.all:n.getElementsByTagName("*");(l={}).clip=n,l.item=[];for(var t=0,i=null;i=e[t];t++)switch(i.className){case"items":case"content":case"background":case"shadowRight":case"shadowBottom":l[i.className]=i;break;case"item":i._index=l.item.length,l.item[i._index]=i}m.elmCache=l})(),function(){for(var e=0,t=null;t=l.item[e];e++)t.onmouseover=y,t.onmouseout=_,t.onclick=k;void 0!==n.tagName&&(n.onmouseover=S,n.onmouseout=C);l.content.onmouseover=A,l.content.onmouseout=O}(),function(){var n=l.items.offsetWidth,t=l.items.offsetHeight,i=navigator.userAgent.toLowerCase();l.clip.style.width=n+TransMenu.shadowSize+2+"px",l.clip.style.height=t+TransMenu.shadowSize+2+"px",l.content.style.width=n+TransMenu.shadowSize+"px",l.content.style.height=t+TransMenu.shadowSize+"px",r=t+TransMenu.shadowSize,u=n+TransMenu.shadowSize,p=e==TransMenu.direction.down||e==TransMenu.direction.up?r:u,(e==TransMenu.direction.left||e==TransMenu.direction.up)&&(p=-p);l.content.style[M]=-p-TransMenu.shadowSize+"px",l.clip.style.visibility="hidden",-1==i.indexOf("mac")||i.indexOf("gecko")>-1?(l.background.style.width=n+"px",l.background.style.height=t+"px",l.background.style.backgroundColor=TransMenu.backgroundColor,l.shadowRight.style.left=n+"px",l.shadowRight.style.height=t-(TransMenu.shadowOffset-TransMenu.shadowSize)+"px",l.shadowRight.style.backgroundColor=TransMenu.shadowColor,l.shadowBottom.style.top=t+"px",l.shadowBottom.style.width=n-TransMenu.shadowOffset+"px",l.shadowBottom.style.backgroundColor=TransMenu.shadowColor):(l.background.firstChild.src=TransMenu.backgroundPng,l.background.firstChild.width=n,l.background.firstChild.height=t,l.shadowRight.firstChild.src=TransMenu.shadowPng,l.shadowRight.style.left=n+"px",l.shadowRight.firstChild.width=TransMenu.shadowSize,l.shadowRight.firstChild.height=t-(TransMenu.shadowOffset-TransMenu.shadowSize),l.shadowBottom.firstChild.src=TransMenu.shadowPng,l.shadowBottom.style.top=t+"px",l.shadowBottom.firstChild.height=TransMenu.shadowSize,l.shadowBottom.firstChild.width=n-TransMenu.shadowOffset)}(),f=!0},this.isOpen=!1,this.show=function(){console.log("show"),f&&(m.isOpen=!0,h=!0,function(){var a=n.constructor==TransMenuItem,o=a?n.parentMenu.elmCache.item[n._index]:n,d=o,h=0,c=0,f=0,m=(window.innerWidth?window.innerWidth:document.body.clientWidth)-parseInt(l.clip.style.width),g=0,M=(window.innerHeight?window.innerHeight:document.body.clientHeight)-parseInt(l.clip.style.height);m=1e4,M=1e4;var p=0,w=0;for(;a?-1==d.parentNode.className.indexOf("transMenu"):d.offsetParent;)h+=d.offsetLeft,c+=d.offsetTop,d.scrollLeft&&(h-=d.scrollLeft),d.scrollTop&&(c-=d.scrollTop),"relative"==T(d=d.offsetParent,"position")&&(p+=d.offsetLeft,w+=d.offsetTop);n.constructor==TransMenuItem&&(h+=parseInt(d.parentNode.style.left),c+=parseInt(d.parentNode.style.top));switch(s){case TransMenu.reference.topLeft:break;case TransMenu.reference.topRight:h+=o.offsetWidth;break;case TransMenu.reference.bottomLeft:c+=o.offsetHeight;break;case TransMenu.reference.bottomRight:var v=l.items.offsetWidth;h+=o.offsetWidth-v,c+=o.offsetHeight}h+=t-p,c+=i-w,h=Math.max(Math.min(h,m),f),c=Math.max(Math.min(c,M),g);v=l.items.offsetWidth;var x=l.items.offsetHeight;r=x+TransMenu.shadowSize,u=v+TransMenu.shadowSize,e==TransMenu.direction.up&&(c-=r);e==TransMenu.direction.left&&(h-=u);l.clip.style.left=h+"px",l.clip.style.top=c+"px"}(),l.clip.style.visibility="visible",l.clip.style.zIndex=TransMenu._maxZ++,w(),m.onactivate())},this.hide=function(){if(f){m.isOpen=!1,h=!0;for(var n=0,e=null;e=l.item[n];n++)b(e);d&&d.hide(),w(),m.ondeactivate()}},this.items=[],this.onactivate=new Function,this.ondeactivate=new Function,this.onmouseover=new Function,this.onqueue=new Function,this.ondequeue=new Function,this.index=TransMenu.registry.length,TransMenu.registry[this.index]=this;var o="TransMenu"+this.index,r=null,u=null,d=null,h=!1,c=[],l=null,f=!1,m=this,g=null,M=e==TransMenu.direction.down||e==TransMenu.direction.up?"top":"left",p=null;function T(n,e){if(n.currentStyle)var t=n.currentStyle[e];else if(window.getComputedStyle)t=document.defaultView.getComputedStyle(n,null).getPropertyValue(e);return t}function w(){var n=parseInt(l.content.style[M]),e=m.isOpen?0:-p;null!=g&&g.stop(),(g=new Accelimation(n,e,TransMenu.slideTime,-1)).onframe=v,g.onend=x,g.start()}function v(n){l.content.style[M]=n+"px"}function x(){m.isOpen||(l.clip.style.visibility="hidden"),h=!1}function b(n){n.className="item",c[n._index]&&(n.lastChild.firstChild.src=TransMenu.dingbatOff)}function y(){var n;h||((n=this).className="item hover",c[n._index]&&(n.lastChild.firstChild.src=TransMenu.dingbatOn),c[this._index]?d.showMenu(c[this._index]):d&&d.hide())}function _(){h||(c[this._index]?d.hideMenu(c[this._index]):b(this))}function k(){if(!h&&m.items[this._index].url)switch(m.items[this._index].browserNav){case 1:window.open(m.items[this._index].url,"","");break;case 2:window.open(m.items[this._index].url,"","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=780,height=550");break;case 3:break;default:location.href=m.items[this._index].url}}function S(){a.showMenu(m)}function C(){a.hideMenu(m)}function A(){h||(a.showMenu(m),m.onmouseover())}function O(){h||a.hideMenu(m)}function z(){h||a.showMenu(m)}function I(){for(var n=0;n<c.length;n++)if(c[n]==this){b(l.item[n]);break}}function P(){a.hideMenu(m)}function B(){a.showMenu(m)}}function TransMenuSet(n,e,t,i){this.addMenu=function(a){var o=new TransMenu(a,n,e,t,i,this);return s[s.length]=o,o},this.showMenu=function(n){n!=o?(null!=o&&u(o),o=n,n.show()):r(n)},this.hideMenu=function(n){o==n&&n.isOpen&&(n.hideTimer||function(n){n.onqueue(),n.hideTimer=window.setTimeout("TransMenuSet.registry["+a.index+"].hide(TransMenu.registry["+n.index+"])",TransMenu.hideDelay)}(n))},this.hide=u,this.hideCurrent=d;var s=[],a=this,o=null;function r(n){n.hideTimer&&(n.ondequeue(),window.clearTimeout(n.hideTimer),n.hideTimer=null)}function u(n){!n&&o&&(n=o),n&&o==n&&n.isOpen&&d()}function d(){null!=o&&(r(o),o.hideTimer=null,o.hide(),o=null)}this.index=TransMenuSet.registry.length,TransMenuSet.registry[this.index]=this}function TransMenuItem(n,e,t,i,s){this.toString=function(e){e?TransMenu.dingbatOff:TransMenu.spacerGif;var t=TransMenu.itemPadding+TransMenu.menuPadding,i="padding:"+TransMenu.itemPadding+"px; padding-left:"+t+"px;";TransMenu.itemPadding;return'<tr class="item"'+(s?' id="active" ':"")+'><td nowrap style="'+i+'">'+n+"</td></tr>"},this.text=n,this.url=e,this.browserNav=i,this.parentMenu=t,this.active=s}function Accelimation(n,e,t,i){void 0===i&&(i=0),"undefined"==typeof unit&&(unit="px"),this.x0=n,this.x1=e,this.dt=t,this.zip=-i,this.unit=unit,this.timer=null,this.onend=new Function,this.onframe=new Function}if(TransMenu.isPathUpdated=0,TransMenu.spacerGif="/images/x.gif",TransMenu.dingbatOn="media/mod_vbs_transmenu/images/arrow.png",TransMenu.dingbatOff="media/mod_vbs_transmenu/images/tabarrow.png",TransMenu.dingbatSize=14,TransMenu.menuPadding=7,TransMenu.itemPadding=5,TransMenu.shadowSize=0,TransMenu.shadowOffset=0,TransMenu.shadowColor="transparent",TransMenu.shadowPng="/media/mod_vbs_transmenu/images/grey-40.png",TransMenu.backgroundColor="transparent",TransMenu.backgroundPng="/media/mod_vbs_transmenu/images/white-90.png",TransMenu.hideDelay=1e3,TransMenu.slideTime=400,TransMenu.subpad_x=0,TransMenu.subpad_y=-2,TransMenu.sMenuId="",TransMenu.reference={topLeft:1,topRight:2,bottomLeft:3,bottomRight:4},TransMenu.direction={down:1,right:2,up:3,left:4},TransMenu.registry=[],TransMenu._maxZ=100,TransMenu.updateImgPath=function(n){TransMenu.isPathUpdated=1,TransMenu.spacerGif=n+TransMenu.spacerGif,TransMenu.dingbatOn=n+TransMenu.dingbatOn,TransMenu.dingbatOff=n+TransMenu.dingbatOff,TransMenu.shadowPng=n+TransMenu.shadowPng,TransMenu.backgroundPng=n+TransMenu.backgroundPng},TransMenu.isSupported=function(){var n=navigator.userAgent.toLowerCase(),e=navigator.platform.toLowerCase(),t=navigator.appName,i=(navigator.productSub,!1);return n.indexOf("gecko")>-1&&navigator.productSub>=20020605||n.indexOf("like gecko")>-1?i=!0:"Microsoft Internet Explorer"==t&&document.getElementById&&(i=0!=e.indexOf("mac")||/msie (\d(.\d*)?)/.test(n)&&Number(RegExp.$1)>=5.1),i},TransMenu.initialize=function(){for(var n=0,e=null;e=this.registry[n];n++)e.initialize()},TransMenu.renderAll=function(){for(var n=[],e=0,t=null;t=this.registry[e];e++)n[e]=t.toString();document.write(n.join(""))},TransMenuSet.registry=[],Accelimation.prototype.start=function(){this.t0=(new Date).getTime(),this.t1=this.t0+this.dt;var n=this.x1-this.x0;this.c1=this.x0+(1+this.zip)*n/3,this.c2=this.x0+(2+this.zip)*n/3,Accelimation._add(this)},Accelimation.prototype.stop=function(){Accelimation._remove(this)},Accelimation.prototype._paint=function(n){if(n<this.t1){var e=n-this.t0;this.onframe(Accelimation._getBezier(e/this.dt,this.x0,this.x1,this.c1,this.c2))}else this._end()},Accelimation.prototype._end=function(){Accelimation._remove(this),this.onframe(this.x1),this.onend()},Accelimation._add=function(n){var e=this.instances.length;this.instances[e]=n,1==this.instances.length&&(this.timerID=window.setInterval("Accelimation._paintAll()",this.targetRes))},Accelimation._remove=function(n){for(var e=0;e<this.instances.length;e++)if(n==this.instances[e]){this.instances=this.instances.slice(0,e).concat(this.instances.slice(e+1));break}0==this.instances.length&&(window.clearInterval(this.timerID),this.timerID=null)},Accelimation._paintAll=function(){for(var n=(new Date).getTime(),e=0;e<this.instances.length;e++)this.instances[e]._paint(n)},Accelimation._B1=function(n){return n*n*n},Accelimation._B2=function(n){return 3*n*n*(1-n)},Accelimation._B3=function(n){return 3*n*(1-n)*(1-n)},Accelimation._B4=function(n){return(1-n)*(1-n)*(1-n)},Accelimation._getBezier=function(n,e,t,i,s){return t*this._B1(n)+s*this._B2(n)+i*this._B3(n)+e*this._B4(n)},Accelimation.instances=[],Accelimation.targetRes=10,Accelimation.timerID=null,window.attachEvent){var cearElementProps=["data","onmouseover","onmouseout","onmousedown","onmouseup","ondblclick","onclick","onselectstart","oncontextmenu"];window.attachEvent("onunload",(function(){for(var n,e=document.all.length;e--;){n=document.all[e];for(var t=cearElementProps.length;t--;)n[cearElementProps[t]]=null}}))}