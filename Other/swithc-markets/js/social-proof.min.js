const SocialProof=(()=>{const o=127462-65;const s=/^[a-z]{2}$/i;const t=425;const e=5*1e3;const n=5*1e3;const a=60*1e3;const i="visible";const c="/img/ffc/maps/";let r;let l;let f;let m;let p;let d=[];let u="SM";let _;let v;let g=[];let h=false;let w=false;const y={FFC:{dataUrl:"/app/ffc/social-proof/",template:`<div class="sm-social-proof sm-social-proof_ffc js-social-proof noimage">\n              <div class="sm-social-proof__inner">\n                  <div class="sm-social-proof__content">\n                      <div class="sm-social-proof__icon"></div>\n                      <div class="sm-social-proof__title">\n                          <div class=""><span class="sm-social-proof__name js-social-proof-name"></span> from&nbsp;<span class="sm-social-proof__country js-social-proof-country"></span>\n                          <span class="sm-social-proof__action">entered the challenge</span></div>\n                          <div class="sm-social-proof__time js-social-proof-time icon icon-clock"></div>\n                      </div>\n                  </div>\n                  <div class="sm-social-proof__map"><img class="sm-social-proof__map-image js-social-proof-image" alt=""></div>\n              </div>\n          </div>`},SM:{dataUrl:"/app/tools/social-proof/",template:`<div class="sm-social-proof js-social-proof noimage">\n            <div class="sm-social-proof__inner">\n                <div class="sm-social-proof__content">\n                    <div class="sm-social-proof__icon"></div>\n                    <div class="sm-social-proof__title">\n                        <div class=""><span class="sm-social-proof__name js-social-proof-name"></span> from&nbsp;<span class="sm-social-proof__country js-social-proof-country"></span>\n                        <span class="sm-social-proof__action">started trading with&nbsp;Switch&nbsp;Markets</span></div>\n                        <div class="sm-social-proof__time js-social-proof-time icon icon-clock"></div>\n                    </div>\n                </div>\n                <div class="sm-social-proof__map"><img class="sm-social-proof__map-image js-social-proof-image" alt=""></div>\n            </div>\n        </div>`}};const j=(o=n)=>{_=setTimeout(b,o)};const S=()=>{clearTimeout(_);clearTimeout(v)};const L=()=>Math.floor(Math.random()*d.length);const T=()=>{let o;do{o=L()}while(g.includes(o));if(g.length===d.length-1){g.length=0}g.push(o);return d[o]};const M=({firstname:o,country:s,regdate:t})=>{l.innerHTML=o;let e=P(s);const n=D(s);f.innerHTML=`${n?`${n}Â `:""}${e}`;t=parseInt(t)*1e3;const a=I(t);m.innerHTML=a?a:"just now";p.src=`${c}${s.toLowerCase()}.png`};const b=async()=>{if(!d.length){await E()}const o=T();M(o)};const E=async()=>{try{const o=await sm_func.getJson(y[u].dataUrl,"POST",{});d=o.data}catch(o){console.error(o);destroy()}};const $=()=>{if(w){return}if(!h){r.classList.toggle(i,true)}h=true;clearTimeout(v);v=setTimeout(k,e)};const k=(o=false)=>{S();j(o?a:n);h=false;r.classList.toggle(i,false)};const q=()=>{r.addEventListener("click",(()=>{k(true)}));p.addEventListener("load",C);p.addEventListener("error",H)};const C=o=>{const s=o.target;if(s.naturalHeight+s.naturalWidth===0){throw new Error("Image load fail")}r.classList.toggle("noimage",false);$()};const H=()=>{r.classList.toggle("noimage",true);$()};const P=t=>{if(!t||!s.test(t)){return""}if(String&&String.fromCodePoint){return String.fromCodePoint(...[...t].map((s=>o+s.charCodeAt(0))))}};const D=o=>{if(!o||!s.test(o)){return""}try{const s=new Intl.DisplayNames(["en"],{type:"region"});return s.of(o)}catch(o){return""}};const I=o=>{const s=o instanceof Date?o:new Date(o);const t=new Intl.RelativeTimeFormat("en");const e={years:3600*24*365,months:3600*24*30,weeks:3600*24*7,days:3600*24,hours:3600,minutes:60,seconds:1};const n=(s.getTime()-Date.now())/1e3;for(let o in e){if(e[o]<Math.abs(n)){const s=n/e[o];return t.format(Math.round(s),o)}}};const A=o=>{document.body.insertAdjacentHTML("beforeend",o);r=document.querySelector(".js-social-proof");l=r.querySelector(".js-social-proof-name");f=r.querySelector(".js-social-proof-country");m=r.querySelector(".js-social-proof-time");p=r.querySelector(".js-social-proof-image")};const F=()=>{if(window.scrollY>0){j();window.removeEventListener("scroll",F)}};return{init(){u=document.currentScript.getAttribute("preset")||u;A(y[u].template);q();if(window.innerWidth>=t){j()}else{window.addEventListener("scroll",F)}},destroy(){w=true;k();S()}}})();SocialProof.init();
